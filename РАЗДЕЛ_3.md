# 3. ПРОГРАММНАЯ ДОКУМЕНТАЦИЯ

## 3.2 Назначение и условия применения

### 3.2.1 Область применения

Система «Менеджер паролей» разработана для применения конечными пользователями, организациями и образовательными учреждениями в целях безопасного управления учётными данными. Она предназначена для использования:

- **Конечными пользователями** — для централизованного хранения и управления паролями к различным онлайн-сервисам и приложениям, генерации криптостойких паролей и оценки надёжности существующих паролей.

- **Корпоративной средой** — как решение для управления учётными данными сотрудников с возможностью централизованного контроля и аудита доступа к корпоративным ресурсам.

- **Образовательными учреждениями** — в качестве практического примера для изучения принципов безопасной разработки программного обеспечения, применения криптографических алгоритмов и построения клиент-серверных систем.

Система обеспечивает защиту конфиденциальных данных пользователей с использованием современных криптографических алгоритмов (Argon2, AES-256-GCM, PBKDF2) и реализует лучшие практики безопасного хранения и передачи информации.

### 3.2.2 Требования к пользователям

Условия использования системы предъявляют различные требования к двум основным категориям пользователей: администраторам, разворачивающим платформу, и конечным пользователям, работающим с приложением.

#### Для конечного пользователя

Основным требованием для использования клиентской части менеджера паролей является наличие компьютера под управлением операционной системы Windows, Linux или macOS с установленной средой выполнения Qt.

**Минимальные системные требования:**
- Операционная система: Windows 7/10/11, Linux (Ubuntu 18.04+, Fedora 30+), macOS 10.14+
- Оперативная память: не менее 512 МБ свободной RAM
- Свободное место на диске: 100 МБ для установки приложения
- Разрешение экрана: минимум 1024×768 пикселей

**Требования к компетенциям пользователя:**
- Базовые навыки работы с графическим интерфейсом операционной системы
- Понимание концепции мастер-пароля и ответственности за его сохранность
- Осведомлённость о необходимости создания резервных копий seed-фразы восстановления
- Желательно (но не обязательно) понимание основ информационной безопасности и важности использования уникальных паролей для разных сервисов

Пользователь должен осознавать важность следующих аспектов безопасности:
- Мастер-пароль (основной пароль для доступа к системе) должен быть достаточно сложным и известен только владельцу
- Кодовое слово для шифрования хранилища не хранится на сервере и должно быть надёжно запомнено
- Seed-фраза восстановления является единственным способом восстановления доступа при утере пароля и должна быть сохранена в безопасном месте

#### Для администратора системы

Для администратора, отвечающего за развёртывание и поддержку серверной части системы, необходимы следующие навыки и знания:

**Технические требования:**
- Навыки работы с командной строкой Linux/Unix
- Базовое администрирование серверных систем
- Понимание принципов работы TCP/IP сетей
- Опыт работы с Docker и docker-compose (для контейнерного развёртывания)
- Знание основ настройки файрволов и сетевой безопасности

**Обязанности администратора:**
- Настройка серверной части приложения (порт, пути к файлам данных)
- Обеспечение резервного копирования данных пользователей (users.json, директория server_vaults/)
- Мониторинг работоспособности сервера и доступности сервиса
- Обновление программного обеспечения при выходе новых версий
- Обеспечение защиты сервера от несанкционированного доступа (настройка firewall, ограничение доступа по IP, использование VPN)

**Рекомендуемая конфигурация сервера:**
- Операционная система: Linux (Ubuntu Server 20.04+, Debian 11+, CentOS 8+)
- Процессор: 2+ ядра
- Оперативная память: минимум 1 ГБ RAM (рекомендуется 2 ГБ и более)
- Свободное место на диске: минимум 10 ГБ (зависит от количества пользователей)
- Сетевое подключение: стабильное интернет-соединение с минимальной задержкой

### 3.2.3 Условия эксплуатации

#### Требования к сетевой инфраструктуре

Для корректной работы системы необходимо обеспечить следующие условия:

- **Сетевое соединение:** клиентское приложение должно иметь доступ к серверу по TCP-протоколу (по умолчанию порт 8080)
- **Пропускная способность:** минимальная пропускная способность сети 1 Мбит/с для комфортной работы
- **Задержка (latency):** рекомендуется не более 500 мс для обеспечения быстрого отклика системы
- **Стабильность соединения:** при нестабильном соединении возможны сбои при синхронизации данных

#### Рекомендации по безопасности

Для обеспечения максимального уровня безопасности при эксплуатации системы рекомендуется:

**Для пользователей:**
- Использовать мастер-пароль длиной не менее 12 символов с комбинацией букв разного регистра, цифр и специальных символов
- Никогда не передавать мастер-пароль и кодовое слово третьим лицам
- Хранить seed-фразу восстановления в надёжном месте (например, в сейфе) отдельно от устройства с установленным приложением
- Регулярно обновлять пароли для критически важных сервисов
- Не использовать общедоступные или незащищённые Wi-Fi сети для работы с менеджером паролей

**Для администраторов:**
- Размещать сервер в защищённой сетевой среде с использованием межсетевого экрана
- Настроить шифрование транспортного уровня (TLS/SSL) для защиты данных при передаче по сети (опционально, для продакшн-среды)
- Регулярно создавать резервные копии данных пользователей
- Мониторить журналы сервера на предмет подозрительной активности
- Ограничить доступ к серверу только для авторизованных IP-адресов (опционально)
- Использовать Docker-контейнеризацию для изоляции приложения от хост-системы

#### Ограничения системы

При использовании системы следует учитывать следующие ограничения:

- **Зависимость от сервера:** при недоступности сервера невозможна синхронизация данных между устройствами
- **Утеря мастер-пароля и seed-фразы:** одновременная утеря мастер-пароля и seed-фразы приводит к невозможности восстановления доступа к хранилищу паролей
- **Масштабируемость:** текущая реализация оптимизирована для работы с небольшими и средними нагрузками (до 1000 одновременных пользователей)
- **Совместимость:** для работы клиентского приложения требуется наличие установленных библиотек Qt и libsodium

### 3.2.4 Режимы работы

Система «Менеджер паролей» поддерживает следующие режимы работы:

#### Локальный режим (standalone)

В данном режиме клиентское приложение работает автономно, без синхронизации с сервером. Все данные хранятся локально на устройстве пользователя. Этот режим подходит для пользователей, которые не нуждаются в синхронизации между несколькими устройствами.

**Преимущества:**
- Полная автономность и независимость от сетевого подключения
- Повышенная конфиденциальность (данные не передаются по сети)
- Простота развёртывания (не требуется настройка сервера)

**Недостатки:**
- Отсутствие автоматической синхронизации между устройствами
- Риск потери данных при выходе из строя устройства (при отсутствии резервного копирования)

#### Клиент-серверный режим

В этом режиме клиентское приложение подключается к серверу для синхронизации зашифрованных данных. Это основной режим работы системы, обеспечивающий централизованное хранение и доступ к паролям с разных устройств.

**Преимущества:**
- Автоматическая синхронизация данных между устройствами
- Централизованное хранение зашифрованных хранилищ на сервере
- Возможность доступа к паролям с любого устройства с установленным клиентом

**Недостатки:**
- Зависимость от доступности сервера и качества сетевого соединения
- Необходимость администрирования серверной части

#### Режим оценки паролей (offline)

Специальный режим работы приложения, позволяющий использовать функцию оценки стойкости паролей без необходимости регистрации или авторизации в системе. Пользователь может проверить надёжность своих существующих паролей, не сохраняя их в хранилище.

**Применение:**
- Быстрая оценка надёжности паролей
- Обучение пользователей принципам создания надёжных паролей
- Аудит безопасности существующих учётных данных

## 3.3 Сообщения пользователю

### 3.3.1 Информационные сообщения

Система выводит информационные сообщения для уведомления пользователя об успешном выполнении операций:

**При регистрации:**
- **"Успех"** — Регистрация прошла успешно. Система создала учётную запись пользователя, сгенерировала seed-фразу восстановления и создала зашифрованное хранилище паролей.

**При работе с паролями:**
- **"Успешно: Пароль успешно сохранён!"** — Новая запись пароля добавлена в хранилище и синхронизирована с сервером.
- **"Успешно: Пароль успешно обновлён!"** — Существующая запись пароля была изменена и синхронизирована с сервером.
- **"Успешно: Пароль удалён"** — Запись пароля удалена из хранилища и изменения синхронизированы с сервером.

**При выходе:**
- **"Выход: Вы вышли из системы"** — Сеанс работы завершён, все чувствительные данные очищены из памяти.

**При восстановлении пароля:**
- **"Пароль восстановлен: Ваш новый пароль установлен"** — Пароль успешно восстановлен с использованием seed-фразы, сгенерирована новая фраза восстановления.

### 3.3.2 Предупреждающие сообщения

Предупреждения информируют пользователя о потенциальных проблемах или необходимости подтверждения действий:

**Ошибки валидации при вводе данных:**
- **"Ошибка: Логин должен содержать не менее 3 символов"** — Введённый логин слишком короткий.
- **"Ошибка: Логин должен содержать не более 30 символов"** — Введённый логин слишком длинный.
- **"Ошибка: Пароль должен содержать не менее 8 символов"** — Пароль не соответствует минимальным требованиям длины.
- **"Ошибка: Пароль должен содержать хотя бы одну строчную букву"** — Отсутствует обязательный класс символов.
- **"Ошибка: Пароль должен содержать хотя бы одну заглавную букву"** — Отсутствует обязательный класс символов.
- **"Ошибка: Пароль должен содержать хотя бы одну цифру"** — Отсутствует обязательный класс символов.
- **"Ошибка: Пароль должен содержать хотя бы один специальный символ"** — Отсутствует обязательный класс символов (!@#$%^&* и т.д.).
- **"Ошибка: Кодовое слово должно содержать не менее 3 символов"** — Кодовое слово слишком короткое.
- **"Ошибка: Кодовое слово должно содержать не более 30 символов"** — Кодовое слово слишком длинное.

**Ошибки при работе с хранилищем:**
- **"Отсутствует информация: Пожалуйста, введите название сервиса"** — Не заполнено обязательное поле при добавлении записи.
- **"Отсутствует информация: Пожалуйста, введите имя пользователя или email"** — Не заполнено обязательное поле при добавлении записи.
- **"Отсутствует информация: Пожалуйста, введите пароль"** — Не заполнено обязательное поле при добавлении записи.
- **"Ошибка валидации: URL должен начинаться с http:// или https://"** — Некорректный формат URL.
- **"Редактировать: Пожалуйста, выберите пароль для редактирования"** — Попытка редактирования без выбора записи.
- **"Удалить: Пожалуйста, выберите пароль для удаления"** — Попытка удаления без выбора записи.

**Предупреждения о безопасности:**
- **"Слабый пароль: Введённый пароль является слабым"** — Пароль прошёл валидацию, но имеет низкую оценку стойкости (найден в словаре распространённых паролей или имеет предсказуемую структуру).
- **"Предупреждение о безопасности: Вы пытаетесь сохранить потенциально слабый пароль"** — Запрос подтверждения при попытке сохранить пароль с низкой оценкой.
- **"Предупреждение: Пароль был скопирован в буфер обмена"** — Напоминание о том, что пароль находится в буфере обмена и может быть доступен другим приложениям.

**Запросы подтверждения:**
- **"Восстановление пароля: Вы уверены, что хотите восстановить пароль?"** — Подтверждение перед началом процедуры восстановления.
- **"Удалить пароль: Вы уверены, что хотите удалить этот пароль?"** — Подтверждение перед удалением записи из хранилища.
- **"Вы уверены, что хотите выйти?"** — Подтверждение перед выходом из системы (все несохранённые изменения будут потеряны).

### 3.3.3 Сообщения об ошибках

Критические ошибки информируют пользователя о невозможности выполнения операции:

**Ошибки аутентификации и авторизации:**
- **"Ошибка: Пользователь уже существует"** — Попытка регистрации с логином, который уже занят другим пользователем.
- **"Ошибка: Пользователь не найден"** — Попытка входа с несуществующим логином.
- **"Ошибка: Неверный пароль"** — Введён неправильный пароль при входе в систему.
- **"Неверное кодовое слово: Введённое кодовое слово неверно"** — Не удалось дешифровать хранилище с предоставленным кодовым словом.
- **"Ошибка: Неверная фраза восстановления"** — Введённая seed-фраза не соответствует сохранённому хешу.

**Ошибки синхронизации и сетевого взаимодействия:**
- **"Ошибка: Не удалось сохранить пароль. Попробуйте снова"** — Не удалось синхронизировать данные с сервером при добавлении записи.
- **"Ошибка: Не удалось обновить пароль. Попробуйте снова"** — Не удалось синхронизировать данные с сервером при изменении записи.
- **"Ошибка: Не удалось удалить пароль. Попробуйте снова"** — Не удалось синхронизировать данные с сервером при удалении записи.
- **"Ошибка: Ошибка создания сокета"** — Не удалось создать сетевое соединение с сервером.
- **"Ошибка: Неверный адрес сервера"** — Указанный адрес сервера некорректен.
- **"Ошибка: Не удалось подключиться к серверу"** — Сервер недоступен или отклонил соединение.
- **"Ошибка: Не получен ответ от сервера"** — Таймаут ожидания ответа от сервера.

**Ошибки генерации и криптографии:**
- **"Ошибка генерации: Libsodium initialization failed"** — Не удалось инициализировать криптографическую библиотеку.
- **"Ошибка генерации: Argon2 hashing failed - out of memory"** — Недостаточно памяти для выполнения хеширования.
- **"Ошибка: Cannot open /dev/urandom"** — Не удалось получить доступ к генератору случайных чисел (Linux).
- **"Ошибка: Failed to read enough random bytes"** — Ошибка при генерации случайных данных.

**Ошибки работы с хранилищем:**
- **"Ошибка: Хранилище пользователя не найдено"** — Файл хранилища пользователя отсутствует на сервере.
- **"Ошибка: Ошибка чтения хранилища пользователя"** — Не удалось прочитать файл хранилища.

### 3.3.4 Отображение seed-фразы восстановления

При регистрации и восстановлении пароля система отображает специальное информационное окно с seed-фразой:

**Заголовок:** "ВАЖНО: Сохраните вашу фразу восстановления"

**Сообщение:**
```
Ваша фраза восстановления:
[12 случайных слов на английском языке, разделённых пробелами]

⚠️ ВАЖНО:
• Сохраните эту фразу в надёжном месте
• Она потребуется для восстановления доступа
• Без неё восстановить пароль будет невозможно
• Никому не сообщайте эту фразу
```

Пользователь должен обязательно записать эту фразу перед продолжением работы.

## 3.4 Аварийные ситуации и действия оператора

### 3.4.1 Потеря соединения с сервером

**Признаки:**
- Сообщения об ошибках "Не удалось подключиться к серверу" при попытке синхронизации
- Таймауты при выполнении операций

**Причины:**
- Сервер остановлен или недоступен
- Сетевые проблемы (нет интернет-соединения)
- Неправильно указан адрес или порт сервера в настройках клиента
- Блокировка соединения файрволом

**Действия пользователя:**
1. Проверить наличие интернет-соединения
2. Убедиться, что адрес и порт сервера указаны корректно
3. Попробовать подключиться позже
4. Связаться с администратором системы

**Действия администратора:**
1. Проверить работоспособность сервера командой `docker ps` (для Docker) или `ps aux | grep server`
2. Проверить доступность порта: `netstat -tuln | grep 8080`
3. Проверить логи сервера на наличие ошибок
4. Перезапустить серверное приложение
5. Проверить настройки файрвола: `sudo ufw status`
6. Восстановить из резервной копии при необходимости

### 3.4.2 Ошибки криптографии

**Признаки:**
- Сообщения "Неверное кодовое слово"
- Невозможность дешифровать хранилище паролей
- Ошибки инициализации libsodium

**Причины:**
- Пользователь забыл или неправильно ввёл кодовое слово
- Повреждение файла хранилища
- Отсутствие или повреждение библиотеки libsodium
- Недостаточно оперативной памяти для криптографических операций

**Действия пользователя:**
1. Внимательно проверить правильность ввода кодового слова
2. При утере кодового слова — использовать процедуру восстановления через seed-фразу
3. При недостатке памяти — закрыть другие приложения
4. Переустановить клиентское приложение (при ошибках libsodium)

**Действия администратора:**
1. Проверить наличие библиотеки libsodium: `ldconfig -p | grep sodium`
2. Проверить целостность файлов хранилищ в директории server_vaults/
3. Восстановить данные из резервной копии
4. Проверить доступную память: `free -h`
5. При необходимости увеличить доступную память для контейнера Docker

### 3.4.3 Утеря мастер-пароля и seed-фразы

**Признаки:**
- Пользователь не может войти в систему
- Отсутствует seed-фраза для восстановления

**Причины:**
- Пользователь забыл мастер-пароль
- Утеряна seed-фраза восстановления

**Действия пользователя:**
1. Попытаться вспомнить пароль, попробовать возможные варианты
2. Если есть seed-фраза — использовать функцию восстановления пароля
3. При утере обоих элементов — доступ к хранилищу **невозможно восстановить**
4. Создать новую учётную запись (предыдущие данные будут утеряны)

**Действия администратора:**
- Администратор **не может** восстановить доступ к зашифрованному хранилищу пользователя без знания кодового слова, так как данные зашифрованы end-to-end
- Можно только удалить старую учётную запись и создать новую

### 3.4.4 Повреждение файла хранилища

**Признаки:**
- Ошибки при чтении хранилища
- Невозможность дешифровать данные даже с правильным кодовым словом
- Сообщения о повреждённых данных

**Причины:**
- Сбой при записи на диск
- Повреждение файловой системы
- Неожиданное отключение сервера
- Ошибки при синхронизации

**Действия пользователя:**
1. Не пытаться повторно сохранять данные
2. Немедленно связаться с администратором

**Действия администратора:**
1. Остановить сервер для предотвращения дальнейшего повреждения
2. Проверить целостность файловой системы: `fsck` (при необходимости)
3. Восстановить файл хранилища из последней резервной копии
4. Проверить журналы сервера на наличие ошибок записи
5. Убедиться в наличии достаточного свободного места на диске: `df -h`

### 3.4.5 Исчерпание памяти на сервере

**Признаки:**
- Медленная работа сервера
- Ошибки "out of memory"
- Отказ в обслуживании новых клиентов

**Причины:**
- Слишком много одновременных подключений
- Утечка памяти в серверном приложении
- Недостаточная конфигурация сервера

**Действия администратора:**
1. Проверить использование памяти: `free -h` и `top`
2. Проверить количество активных процессов: `ps aux | grep server`
3. Перезапустить серверное приложение
4. Увеличить доступную память в конфигурации Docker (если используется)
5. Оптимизировать количество одновременных подключений
6. Рассмотреть возможность масштабирования (использование более мощного сервера)

### 3.4.6 Потеря данных пользователей

**Признаки:**
- Отсутствие файла users.json
- Пустая директория server_vaults/
- Ошибки при попытке входа зарегистрированных пользователей

**Причины:**
- Удаление файлов администратором по ошибке
- Сбой диска
- Неправильное развёртывание новой версии

**Действия администратора:**
1. **Немедленно** остановить сервер
2. Не перезаписывать существующие файлы
3. Восстановить users.json из резервной копии
4. Восстановить директорию server_vaults/ из резервной копии
5. Проверить целостность восстановленных данных
6. Перезапустить сервер и провести тестирование
7. Проанализировать причину потери данных и принять меры для предотвращения повторения

**Профилактика:**
- Настроить автоматическое резервное копирование (ежедневно)
- Хранить копии в отдельном физическом расположении
- Использовать системы контроля версий для критических файлов
- Регулярно проверять целостность резервных копий
